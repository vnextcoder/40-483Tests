/*
 Copyright (c) Microsoft Corporation.  All rights reserved.
 This code is licensed by Microsoft Corporation under the terms
 of the MICROSOFT REACTIVE EXTENSIONS FOR JAVASCRIPT AND .NET LIBRARIES License.
 See http://go.microsoft.com/fwlink/?LinkID=220762.
*/
(function(n){var c;c="undefined"!==typeof exports?require("./rx.min"):n.Rx;var s=function(a,b){return!a.equals?a===b:a.equals(b)},p=c.Observable,i=c.Notification,t=c.VirtualTimeScheduler,n=c.Disposable,j=n.empty,q=n.create,u=c.CompositeDisposable,r=Array.prototype.slice,v=Object.prototype.hasOwnProperty,o=function(a,b){function e(){this.constructor=a}for(var d in b)"prototype"!==d&&v.call(b,d)&&(a[d]=b[d]);e.prototype=b.prototype;a.prototype=new e;a.base=b.prototype;return a},w=function(a){for(var b=
0;b<this.length;)this[b]===a?this.splice(b,1):b++},m=c.ReactiveTest={created:100,subscribed:200,disposed:1E3,onNext:function(a,b){return new k(a,i.createOnNext(b))},onError:function(a,b){return new k(a,i.createOnError(b))},onCompleted:function(a){return new k(a,i.createOnCompleted())},subscribe:function(a,b){return new l(a,b)}},k=c.Recorded=function(){function a(b,a,d){this.time=b;this.value=a;this.comparer=d||s}a.prototype.equals=function(b){return this.time===b.time&&this.comparer(this.value,b.value)};
a.prototype.toString=function(){return this.value.toString()+"@"+this.time};return a}(),l=c.Subscription=function(){function a(b,a){this.subscribe=b;this.unsubscribe=a||Number.MAX_VALUE}a.prototype.equals=function(b){return this.subscribe===b.subscribe&&this.unsubscribe===b.unsubscribe};a.prototype.toString=function(){return this.unsubscribe===Number.MAX_VALUE?"("+this.subscribe+", Infinite)":"("+this.subscribe+", "+this.unsubscribe+")"};return a}();c.MockDisposable=function(){function a(b){this.scheduler=
b;this.disposes=[];this.disposes.push(this.scheduler.clock)}a.prototype.dispose=function(){this.disposes.push(this.scheduler.clock)};return a}();var x=c.MockObserver=function(){function a(b){this.scheduler=b;this.messages=[]}o(a,c.Observer);a.prototype.onNext=function(b){this.messages.push(new k(this.scheduler.clock,i.createOnNext(b)))};a.prototype.onError=function(b){this.messages.push(new k(this.scheduler.clock,i.createOnError(b)))};a.prototype.onCompleted=function(){this.messages.push(new k(this.scheduler.clock,
i.createOnCompleted()))};return a}(),y=function(){function a(b,a){var d,c,f,g=this;this.scheduler=b;this.messages=a;this.subscriptions=[];this.observers=[];for(f=0;f<this.messages.length;f++)d=this.messages[f],c=d.value,function(a){b.scheduleAbsolute(null,d.time,function(){for(var b=0;b<g.observers.length;b++)a.accept(g.observers[b]);return j})}(c)}o(a,p);a.prototype._subscribe=function(b){var a,d=this;this.observers.push(b);this.subscriptions.push(new l(this.scheduler.clock));a=this.subscriptions.length-
1;return q(function(){w.call(d.observers,b);return d.subscriptions[a]=new l(d.subscriptions[a].subscribe,d.scheduler.clock)})};return a}(),z=function(){function a(b,e){a.base.constructor.call(this);this.scheduler=b;this.messages=e;this.subscriptions=[]}o(a,p);a.prototype._subscribe=function(a){var e,d,c,f,g=this,h;this.subscriptions.push(new l(this.scheduler.clock));d=this.subscriptions.length-1;e=new u;for(h=0;h<this.messages.length;h++)c=this.messages[h],f=c.value,function(d){e.add(g.scheduler.scheduleRelative(null,
c.time,function(){d.accept(a);return j}))}(f);return q(function(){g.subscriptions[d]=new l(g.subscriptions[d].subscribe,g.scheduler.clock);e.dispose()})};return a}();c.TestScheduler=function(){function a(){a.base.constructor.call(this,0,function(a,e){return a-e})}o(a,t);a.prototype.scheduleAbsolute=function(b,e,d){e<=this.clock&&(e=this.clock+1);return a.base.scheduleAbsolute.call(this,b,e,d)};a.prototype.add=function(a,e){return a+e};a.prototype.toDateTimeOffset=function(a){return(new Date(a)).getTime()};
a.prototype.toRelative=function(a){return a};a.prototype.startWithTiming=function(a,e,d,c){var f=this.createObserver(),g,h;this.scheduleAbsolute(null,e,function(){g=a();return j});this.scheduleAbsolute(null,d,function(){h=g.subscribe(f);return j});this.scheduleAbsolute(null,c,function(){h.dispose();return j});this.start();return f};a.prototype.startWithDispose=function(a,c){return this.startWithTiming(a,m.created,m.subscribed,c)};a.prototype.startWithCreate=function(a){return this.startWithTiming(a,
m.created,m.subscribed,m.disposed)};a.prototype.createHotObservable=function(){var a=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:r.call(arguments);return new y(this,a)};a.prototype.createColdObservable=function(){var a=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:r.call(arguments);return new z(this,a)};a.prototype.createObserver=function(){return new x(this)};a.prototype.scheduleWithTime=function(a,c){return this.scheduleRelative(null,c,function(){a();return j})};
return a}()})(this);
